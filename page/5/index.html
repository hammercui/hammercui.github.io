<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="hammer崔的程序世界" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="hammer崔的程序世界">
<meta property="og:url" content="http://hammercui.github.io/page/5/index.html">
<meta property="og:site_name" content="hammer崔的程序世界">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="hammer崔的程序世界">
<meta name="twitter:description">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 6263296159406622000,
      author: '博主大人'
    }
  };
</script>




  <link rel="canonical" href="http://hammercui.github.io/page/5/"/>

  <title> hammer崔的程序世界 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?4c0e7eb512fab8f2d1682c1bff044651";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">hammer崔的程序世界</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">我的生涯一片无悔，我想起那个午夜在灯泡下的抠代码，那是我逝去的青春！</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/android基础：applicationId与packageName的区别/" itemprop="url">
                  android基础：applicationId与packageName的区别
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-23T15:41:11+08:00" content="2016-03-23">
              2016-03-23
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/android/" itemprop="url" rel="index">
                    <span itemprop="name">android</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/post/android基础：applicationId与packageName的区别/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="post/android基础：applicationId与packageName的区别/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p><code>applicationId</code>：在Android系统中应用的<code>applicationId</code>作为应用的唯一标识，就像人的身份证号一样，在一个Android设备中所有的应用程序的<code>applicationId</code>都是唯一的。</p>
</blockquote>
<h1 id="eclipse版本"><a href="#eclipse版本" class="headerlink" title="eclipse版本"></a>eclipse版本</h1><p><code>package name</code>：在用Eclipse构建的Android项目中，使用包名(Package Name)作为应用的唯一标识（<code>applicationId</code>）。可以说在Eclipse下<code>applicationId</code>=<code>package name</code>。所以Eclipse构建的Android项目包名必须唯一，一个包名代表一个应用，不允许两个应用使用同样的包名。包名主要用于系统识别应用，几乎不会被最终用户看到。</p>
<h1 id="androidStudo版本"><a href="#androidStudo版本" class="headerlink" title="androidStudo版本"></a>androidStudo版本</h1><p>在用Android studio构建的Android项目中可以为应用配置<code>applicationId</code>·，配置的<code>applicationId</code>可以不和<code>package name</code>一样。由此可以看来用Android studio构建的Android项目<code>package name</code>不一定是应用程序的标识。这一点很重要，开发者一定要记住。比如你在使用第三方SDK开发时，如百度地图，需要你来设置Android SDK安全码，在设置安全码时需要用到应用程序的包名，这个包名指的是<code>applicationId</code>。</p>
<p><strong>注意</strong>：识别.R跟Activity文件的路径还是packageName,这个是唯一的</p>
<h2 id="解耦方案"><a href="#解耦方案" class="headerlink" title="解耦方案"></a>解耦方案</h2><ul>
<li><code>application id</code> 对应 apk 中 manifest 定义的应用包名，同时用于设备以及 Google Play 的应用唯一标识。</li>
<li><code>package</code> 用于在源码中引用 R 类以及解析注册相关的 activity/service，对应 Java 的包名概念。</li>
</ul>
<p>我们在AndroidManifest.xml定义一个包名，这个是唯一的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    package=&quot;com.hammercui.app.react&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>我们在<code>app.gradle</code>文件使用Gradle DSL 方法来为不同的 flavor 和 build type 定义不同的 applicationId：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">android&#123;</span><br><span class="line">···</span><br><span class="line">productFlavors &#123;</span><br><span class="line">        pro &#123;</span><br><span class="line">            applicationId = &quot;com.hammercui.app.pro&quot;</span><br><span class="line">        &#125;</span><br><span class="line">        free &#123;</span><br><span class="line">            applicationId = &quot;com.hammercui.app.free&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        debug &#123;</span><br><span class="line">            applicationIdSuffix &quot;.debug&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h1><p><a href="https://chaosleong.gitbooks.io/gradle-for-android/content/appendix/applicationid_versus_packagename.html" target="_blank" rel="external">Gradle Android Plugin中文手册</a></p>
<p><a href="http://siroccoicode.club/?p=574" target="_blank" rel="external">applicationID和packageName的区别</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/react-native基础：热更新/" itemprop="url">
                  react-native基础：热更新
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-21T18:17:42+08:00" content="2016-03-21">
              2016-03-21
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/react-native-basis/" itemprop="url" rel="index">
                    <span itemprop="name">react-native basis</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/post/react-native基础：热更新/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="post/react-native基础：热更新/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="已知的热更新方案"><a href="#已知的热更新方案" class="headerlink" title="已知的热更新方案"></a>已知的热更新方案</h1><ul>
<li><p><a href="https://github.com/Microsoft/react-native-code-push" target="_blank" rel="external">CodePush</a> ,我在使用的方案，同时支持android跟ios，可以点击查看我的详细教程<a href="http://hammercui.github.io/post/react-native-android%E5%AE%9E%E6%88%98%EF%BC%9A4-CodePush/">react-native-android实战：4 CodePush使用</a></p>
</li>
<li><p><a href="http://blog.csdn.net/kid1986513/article/details/50337083" target="_blank" rel="external">React Native for Android 热部署图片自定义方案</a></p>
</li>
<li><p><a href="React-Native Android 热更新">React-Native Android 热更新</a>,这个方案对反射的方案做了补充</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/购物清单/" itemprop="url">
                  购物清单
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-20T21:09:51+08:00" content="2016-03-20">
              2016-03-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/生活常识/" itemprop="url" rel="index">
                    <span itemprop="name">生活常识</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/post/购物清单/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="post/购物清单/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="家用电器"><a href="#家用电器" class="headerlink" title="家用电器"></a>家用电器</h1><h2 id="洗衣机"><a href="#洗衣机" class="headerlink" title="洗衣机"></a>洗衣机</h2><table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>价格</th>
<th>个人评价</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://product.suning.com/0000000000/128927868.html" target="_blank" rel="external">海尔滚筒洗衣机XQG80-BX12636</a></td>
<td>滚筒</td>
<td>2899</td>
<td>担心小孩，次要考虑</td>
</tr>
<tr>
<td><a href="http://product.suning.com/0000000000/126705291.html" target="_blank" rel="external">海尔洗衣机XQS70-Z1626</a></td>
<td>波轮</td>
<td>2599</td>
<td>这个不错，防缠绕</td>
</tr>
</tbody>
</table>
<h2 id="冰箱"><a href="#冰箱" class="headerlink" title="冰箱"></a>冰箱</h2><table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>价格</th>
<th>个人评价</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://product.suning.com/0000000000/127894615.html" target="_blank" rel="external">海尔冰箱BCD-248WDPM</a></td>
<td>双开门</td>
<td>2288</td>
<td>风冷无霜</td>
</tr>
<tr>
<td><a href="http://product.suning.com/0000000000/127356379.html" target="_blank" rel="external">海尔冰箱BCD-251WDBD</a></td>
<td>双开门</td>
<td>2699</td>
<td>风冷无霜</td>
</tr>
<tr>
<td><a href="http://product.suning.com/0000000000/123397587.html" target="_blank" rel="external">美菱冰箱BCD-220L3BX芙蓉红</a></td>
<td>三开门</td>
<td>1699</td>
<td>红色，其他无特点</td>
</tr>
</tbody>
</table>
<h2 id="电视"><a href="#电视" class="headerlink" title="电视"></a>电视</h2><table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>价格</th>
<th>个人评价</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://product.suning.com/0000000000/128582435.html" target="_blank" rel="external">三星(SAMSUNG) UA58J50SWAJXXZ</a></td>
<td>58英寸 全高清 LED液晶电视</td>
<td>4599</td>
<td>首选项，放弃4k</td>
</tr>
<tr>
<td><a href="http://product.suning.com/0000000000/126643209.html" target="_blank" rel="external">夏普(SHARP) LCD-55S3A</a></td>
<td>55英寸</td>
<td>4999</td>
<td>4K超高清 智能网络 液晶电视</td>
</tr>
</tbody>
</table>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/react-native-android实战：4-CodePush/" itemprop="url">
                  react-native-android实战：4 CodePush使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-18T10:00:38+08:00" content="2016-03-18">
              2016-03-18
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/react-native-android实战/" itemprop="url" rel="index">
                    <span itemprop="name">react-native android实战</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/post/react-native-android实战：4-CodePush/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="post/react-native-android实战：4-CodePush/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="CodePush简介"><a href="#CodePush简介" class="headerlink" title="CodePush简介"></a>CodePush简介</h1><p><a href="http://microsoft.github.io/code-push/" target="_blank" rel="external">CodePush</a> 是微软开发的，可以实时更新 React Native 和 Cordova 应用。</p>
<p>CodePush 是提供给 React Native 和 Cordova 开发者直接部署移动应用更新给用户设备的云服务。CodePush 作为一个中央仓库，开发者可以推送更新到 (JS, HTML, CSS and images)，应用可以从客户端 SDKs 里面查询更新。CodePush 可以让应用有更多的可确定性，也可以让你直接接触用户群。在修复一些小问题和添加新特性的时候，不需要经过二进制打包，可以直接推送代码进行实时更新。</p>
<p>CodePush 可以进行实时的推送代码更新：</p>
<ul>
<li>直接对用户部署代码更新</li>
<li>管理 Alpha，Beta 和生产环境应用</li>
<li>支持 Cordova 和 React Native </li>
</ul>
<p><strong>CodePush的react-native版本是<a href="https://github.com/Microsoft/react-native-code-push" target="_blank" rel="external">react-native-code-push</a></strong></p>
<h1 id="JavaScript-API"><a href="#JavaScript-API" class="headerlink" title="JavaScript API"></a>JavaScript API</h1><ul>
<li>checkForUpdate</li>
<li>getCurrentPackage</li>
<li>notifyApplicationReady</li>
<li>restartApp </li>
<li>sync</li>
</ul>
<h2 id="codePush-checkForUpdate"><a href="#codePush-checkForUpdate" class="headerlink" title="codePush.checkForUpdate"></a>codePush.checkForUpdate</h2><p>询问<code>code push</code> 服务器是否app有新的版本</p>
<p><code>codePush.checkForUpdate(deploymentKey: String = null): Promise&lt;RemotePackage&gt;;</code></p>
<p>该方法返回Promise，有如下两种值：</p>
<ol>
<li>null 没有更新</li>
<li>A RemotePackage instance</li>
</ol>
<p>举例用法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">codePush.checkForUpdate()</span><br><span class="line">.then((update) =&gt; &#123;</span><br><span class="line">    if (!update) &#123;</span><br><span class="line">        console.log(&quot;The app is up to date!&quot;); </span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        console.log(&quot;An update is available! Should we download it?&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h2 id="codePush-getCurrentPackage"><a href="#codePush-getCurrentPackage" class="headerlink" title="codePush.getCurrentPackage"></a><code>codePush.getCurrentPackage</code></h2><p>获得当前已安装更新的元数据（比如描述，安装时间，大小）<br>举例:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">codePush.getCurrentPackage()</span><br><span class="line">.then((update) =&gt; &#123;</span><br><span class="line">    // If the current app &quot;session&quot; represents the first time</span><br><span class="line">    // this update has run, and it had a description provided</span><br><span class="line">    // with it upon release, let&apos;s show it to the end user</span><br><span class="line">    if (update.isFirstRun &amp;&amp; update.description) &#123;</span><br><span class="line">        // Display a &quot;what&apos;s new?&quot; modal</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h2 id="codePush-notifyApplicationReady"><a href="#codePush-notifyApplicationReady" class="headerlink" title="codePush.notifyApplicationReady"></a><code>codePush.notifyApplicationReady</code></h2><p>通知CodePush进程，一个更新安装好了。当你检查并安装更新，（比如没有使用sync方法去handle的时候），这个方法必须被调用。否则CodePush会认为update失败，并rollback当前版本，在app重启时。</p>
<p>当使用<code>sync</code>方法时，不需要调用本方法，因为<code>sync</code>会自动调用，</p>
<h2 id="codePush-restartApp"><a href="#codePush-restartApp" class="headerlink" title="codePush.restartApp"></a><code>codePush.restartApp</code></h2><p>立即重启app.</p>
<p>当以下情况时，这个方式是很有用的。：</p>
<ol>
<li>app 当 调用 <code>sync</code> or <code>LocalPackage.install</code> 方法时，指定的 install mode 是 <code>ON_NEXT_RESTART</code> or <code>ON_NEXT_RESUME</code>时 . 这两种情况都是当app重启或resume时，更新内容才能被看到。</li>
<li>You have an app-specific user event (e.g. the end user navigated back to the app’s home route) that allows you to apply the update in an unobtrusive way, and potentially gets the update in front of the end user sooner then waiting until the next restart or resume.</li>
</ol>
<p>因为强制重启，能马上显示更新内容嘛！</p>
<h2 id="codePush-sync"><a href="#codePush-sync" class="headerlink" title="codePush.sync"></a><code>codePush.sync</code></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">codePush.sync(options: Object, syncStatusChangeCallback: function(syncStatus: Number), downloadProgressCallback: function(progress: DownloadProgress)): Promise&lt;Number&gt;;</span><br></pre></td></tr></table></figure>
<p>允许检查更新，下载并安装，都在一个方法中。除非你需要自定义UI开表现。我们建议开发者在整合CodePush时，使用这个函数。<br>checkForUpdate方法只能检查更新，接下来怎么做要自己写。而该方法更新，下载，安装都能处理。该方法提供了两种模式</p>
<ul>
<li><code>Silent mode</code>（默认的模式），</li>
</ul>
<p>它会自动下载可用更新，并在下次重启应用时应用它们（比如操作系统或用户杀死进程，或者重新启动设备） 。这样一来，整个更新是“沉默”给最终用户，因为用户看不到任何更新提示。</p>
<ul>
<li><code>Active mode</code></li>
</ul>
<p>当有可用的更新，提示用户是否允许下载，然后立即应用此更新。一旦选择了强制通知用户来手动更新，以后每次更新都会强制通知。个人感觉这种方式最合理</p>
<p><code>sync</code>方法，有以下设置属性</p>
<ul>
<li><code>deploymentKey</code> （String）： 部署key，用来区分不同的app,在<code>Info.plist</code>(Ios)和<code>MianActivity.java</code>(Android)修改，当然你也可以在JavaScript里填写，这样我们能动态的修改key</li>
<li><code>installMode</code> (codePush.InstallMode)： 非强制更新，默认<code>codePush.InstallMode.ON_NEXT_RESTART</code></li>
<li><code>mandatoryInstallMode</code> (codePush.InstallMode):强制更新,默认<code>codePush.InstallMode.IMMEDIATE</code></li>
<li><code>minimumBackgroundDuration</code> (Number):</li>
<li><p><code>updateDialog</code> (UpdateDialogOptions) :可选的，更新的对话框，默认是null,包含以下属性</p>
<ul>
<li><p><code>appendReleaseDescription</code> (Boolean) - 是否显示更新description，默认false</p>
</li>
<li><p><code>descriptionPrefix</code> (String) - 更新说明的前缀。 默认是” Description: “</p>
</li>
<li><p><code>mandatoryContinueButtonLabel</code> (String) - 强制更新的按钮文字. 默认 to “Continue”.</p>
</li>
<li><p><code>mandatoryUpdateMessage</code> (String) - 强制更新时，更新通知. Defaults to “An update is available that must be installed.”.</p>
</li>
<li><p><code>optionalIgnoreButtonLabel</code> (String) - 非强制更新时，取消按钮文字. Defaults to “Ignore”.</p>
</li>
<li><p><code>optionalInstallButtonLabel</code> (String) - 非强制更新时，确认文字. Defaults to “Install”.</p>
</li>
<li><p><code>optionalUpdateMessage</code> (String) - 非强制更新时，更新通知. Defaults to “An update is available. Would you like to install it?”.</p>
</li>
<li><p><code>title</code> (String) - 要显示的更新通知的标题. Defaults to “Update available”.</p>
</li>
</ul>
</li>
</ul>
<p>举例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// Prompt the user when an update is available</span><br><span class="line">// and then display a &quot;downloading&quot; modal </span><br><span class="line">codePush.sync(&#123; updateDialog: true &#125;, (status) =&gt; &#123;</span><br><span class="line">    switch (status) &#123;</span><br><span class="line">        case codePush.SyncStatus.DOWNLOADING_PACKAGE:</span><br><span class="line">            // Show &quot;downloading&quot; modal</span><br><span class="line">            break;</span><br><span class="line">        case codePush.SyncStatus.INSTALLING_UPDATE:</span><br><span class="line">            // Hide &quot;downloading&quot; modal</span><br><span class="line">            break;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/Microsoft/react-native-code-push/blob/master/Examples/CodePushDemoApp/crossplatformdemo.js#L68" target="_blank" rel="external">再贴一个官方demo地址</a></p>
<h1 id="实战应用"><a href="#实战应用" class="headerlink" title="实战应用"></a>实战应用</h1><h2 id="Service部署"><a href="#Service部署" class="headerlink" title="Service部署"></a>Service部署</h2><h3 id="安装CodePush-CLI"><a href="#安装CodePush-CLI" class="headerlink" title="安装CodePush CLI"></a>安装CodePush CLI</h3><p><code>npm install -g code-push-cli</code></p>
<p>可以输入<code>code-push -v</code>查看版本号</p>
<h3 id="创建CodePush-账号"><a href="#创建CodePush-账号" class="headerlink" title="创建CodePush 账号"></a>创建CodePush 账号</h3><p>在发布一个更新前，必须有账号。</p>
<ul>
<li>终端输入<code>code-push register</code>,执行后弹出<a href="https://codepush-management.azurewebsites.net/auth/register?hostname=DESKTOP-3PVIHT6，" target="_blank" rel="external">https://codepush-management.azurewebsites.net/auth/register?hostname=DESKTOP-3PVIHT6，</a></li>
<li>选择输入微软账号或者github账号，选择Authorize application。然后注册成功，获得一个token。</li>
<li>token输入到控制台，显示<br><img src="http://7xrf0l.com1.z0.glb.clouddn.com/16-3-18/11301899.jpg" alt=""></li>
<li>登录 <code>code-push login</code></li>
<li>注销 <code>code-push loout</code></li>
<li>列出登录的token<code>code-push access-key ls</code></li>
<li>删除某个access-key <code>code-push access-key rm &lt;accessKey&gt;</code></li>
</ul>
<h3 id="注册一个app"><a href="#注册一个app" class="headerlink" title="注册一个app"></a>注册一个app</h3><p>常用命令,只有下面几个：</p>
<ul>
<li><code>access-key</code>    View and delete active user sessions</li>
<li><code>app</code>         View and manage your CodePush-enabled apps</li>
<li><code>collaborator</code>   View and manage collaborators for a given app</li>
<li><code>deployment</code>     View and manage the deployments for your apps</li>
<li><code>login</code>         Authenticate with the CodePush server in order to begin managing your apps</li>
<li><code>logout</code>       Log out of the current session</li>
<li><code>promote</code>      Promote the package from one deployment of your app to another</li>
<li><code>register</code>       Register a new account with the CodePush server</li>
<li><code>release</code>       Release a new version of your app to a specific deployment</li>
<li><code>release-react</code> Release a new version of your React Native app to a specific deployment</li>
<li><code>rollback</code>       Performs a rollback on the latest package of a specific deployment</li>
</ul>
<p>选项：</p>
<ul>
<li>-v, –version  显示版本号  [boolean]</li>
</ul>
<p>比如</p>
<ul>
<li>查看当前部署的app: <code>code-push app ls</code></li>
<li>添加一个app:  <code>code-push app add Zlot_react</code></li>
</ul>
<h3 id="部署已经注册的app"><a href="#部署已经注册的app" class="headerlink" title="部署已经注册的app"></a>部署已经注册的app</h3><ul>
<li>部署: <code>code-push deployment add app名字 部署名</code></li>
<li>重命名部署名： <code>code-push deployment rename app名字 旧部署名 新部署名</code></li>
<li>删除部署名字:  <code>code-push deployment rm app名字 部署名字</code></li>
<li>列表部署名字: <code>code-push deployment ls app名字</code></li>
<li>查看部署的key: <code>code-push deployment ls app名 -k</code></li>
<li>查看release 的历史版本<br><code>code-push deployment history appName deploymentName</code></li>
</ul>
<p><strong>注意：默认的部署名是staging，所以staging的key值就是我们的deployment key</strong></p>
<h2 id="react-native-code-push插件安装"><a href="#react-native-code-push插件安装" class="headerlink" title="react-native-code-push插件安装"></a>react-native-code-push插件安装</h2><p>需要有git环境，并在app工程目录控制台输入</p>
<p><code>npm install react-native-code-push --save</code></p>
<p>安装成功在package.json会看到</p>
<p><code>&quot;react-native-code-push&quot;: &quot;^1.8.0-beta&quot;,</code></p>
<h2 id="android配置"><a href="#android配置" class="headerlink" title="android配置"></a>android配置</h2><ul>
<li>编辑android/setting.gradle文件，添加</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">include &apos;:app&apos;, &apos;:react-native-code-push&apos;</span><br><span class="line">project(&apos;:react-native-code-push&apos;).projectDir = new File(rootProject.projectDir, &apos;../node_modules/react-native-code-push/android/app&apos;)</span><br></pre></td></tr></table></figure>
<ul>
<li>编辑android/app/builde.gradle文件，添加依赖<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compile project(&apos;:react-native-code-push&apos;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>android react-native v0.18.0+</strong></p>
<blockquote>
<p>此种配置方法仅仅适用react-native 0.18版本及其以上。而且是android studio环境</p>
</blockquote>
<ul>
<li>修改<code>MainActivity.java</code>文件,添加CodePush包</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">// 1. Import the plugin class</span><br><span class="line">import com.microsoft.codepush.react.CodePush;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public class MainActivity extends ReactActivity &#123;</span><br><span class="line">    // 2. Define a private field to hold the CodePush runtime instance</span><br><span class="line">    private CodePush _codePush;</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    // 3. Override the getJSBundleFile method in order to let</span><br><span class="line">    // the CodePush runtime determine where to get the JS</span><br><span class="line">    // bundle location from on each app start</span><br><span class="line">    @Override</span><br><span class="line">    protected String getJSBundleFile() &#123;</span><br><span class="line">        return this._codePush.getBundleUrl(&quot;index.android.bundle&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected List&lt;ReactPackage&gt; getPackages() &#123;</span><br><span class="line">        // 4. Instantiate an instance of the CodePush runtime, using the right deployment key. If you don&apos;t</span><br><span class="line">        // already have it, you can run &quot;code-push deployment ls &lt;appName&gt; -k&quot; to retrieve your key.</span><br><span class="line">        this._codePush = new CodePush(&quot;0dsIDongIcoH0mqAmoR0CYb5FhBZNy1w4Bf-l&quot;, this, BuildConfig.DEBUG);</span><br><span class="line"></span><br><span class="line">        // 5. Add the CodePush package to the list of existing packages</span><br><span class="line">        return Arrays.&lt;ReactPackage&gt;asList(</span><br><span class="line">            new MainReactPackage(), this._codePush.getReactPackage());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>确定在<code>android/app/build.gradle</code>文件有<code>android.defaultConfig.versionName</code>属性</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">    ...</span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        ...</span><br><span class="line">        versionName &quot;1.0.0&quot;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="JavaScript代码"><a href="#JavaScript代码" class="headerlink" title="JavaScript代码"></a>JavaScript代码</h2><ul>
<li>导入CodePush的JavaScript组件</li>
</ul>
<p><code>import codePush from &quot;react-native-code-push&quot;;</code></p>
<ul>
<li>在在每个app启动时，在生命周期的<code>componentDidMount</code>阶段调用<code>sync</code>,来开启一个后台的更新。</li>
</ul>
<p><code>codePush.sync();</code></p>
<h3 id="设计方案"><a href="#设计方案" class="headerlink" title="设计方案"></a>设计方案</h3><ul>
<li><code>isMandatory === true</code>强制更新，采用弹出model框提醒的方式</li>
</ul>
<ul>
<li><code>isMandatory === false</code>非强制更新，采用静默安装的方式</li>
</ul>
<p>如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">componentDidMount() &#123;</span><br><span class="line">    codePush.sync(&#123;</span><br><span class="line">      updateDialog: false,</span><br><span class="line">      installMode: codePush.InstallMode.ON_NEXT_RESUME,</span><br><span class="line">      deploymentKey: CODE_PUSH_PRODUCTION_KEY,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure></p>
<h2 id="app如何更新（JavaScript-image）"><a href="#app如何更新（JavaScript-image）" class="headerlink" title="app如何更新（JavaScript+image）"></a>app如何更新（JavaScript+image）</h2><blockquote>
<p>注意：从react-native v0.19.0开始支持android更新assets资源，并且需要CodePush v1.7.0。所以你需要升级你的react-native跟CodePush。</p>
</blockquote>
<p>确保在工程目录,新建release文件夹,如下</p>
<h3 id="package命令"><a href="#package命令" class="headerlink" title="package命令"></a>package命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">react-native bundle </span><br><span class="line">--platform ios 选择平台</span><br><span class="line">--entry-file index.ios.js  选择启动项</span><br><span class="line">--bundle-output ./release/main.jsbundle  选择打包js输出文件</span><br><span class="line">--assets-dest ./release \  选择资源输出目录</span><br><span class="line">--dev false  是否调试</span><br></pre></td></tr></table></figure>
<ul>
<li><p>Android版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">react-native bundle --platform android --entry-file index.android.js --bundle-output ./release/main.jsbundle  --assets-dest ./release --dev false</span><br></pre></td></tr></table></figure>
</li>
<li><p>ios版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">react-native bundle --platform ios --entry-file index.ios.js --bundle-output ./release/main.jsbundle  --assets-dest ./release --dev false</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="release命令"><a href="#release命令" class="headerlink" title="release命令"></a>release命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">code-push release &lt;appName&gt; &lt;updateContents&gt; &lt;targetBinaryVersion&gt;</span><br><span class="line">[--deploymentName &lt;deploymentName&gt;]</span><br><span class="line">[--description &lt;description&gt;]</span><br><span class="line">[--mandatory]</span><br></pre></td></tr></table></figure>
<p>mandatory ：是否强制更新。</p>
<p><strong>注意：targetBinaryVersion指的是当前的app版本，比如客户端是1.0.0，如果我们要更新客户端，targetBinaryVersion也要是1.0.0，表示是1.0.0版本的更新，跟native的更新不太一样。这是我们第一次经常犯的错误大家不要搞混了。</strong></p>
<ul>
<li>Android版本<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code-push release Zlot ./release 1.0.0 --description &quot;这是一个1.0.0版本的更新&quot; --mandatory true</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h1><h2 id="1-更新不成功，报but-it-is-being-ignored-due-to-having-been-previously-rolled-back"><a href="#1-更新不成功，报but-it-is-being-ignored-due-to-having-been-previously-rolled-back" class="headerlink" title="1 更新不成功，报but it is being ignored due to having been previously rolled back."></a>1 更新不成功，报<code>but it is being ignored due to having been previously rolled back.</code></h2><p>问题原因：客户端版本1.0.0，然后release的版本是1.0.1，所以检测的时候发现不了1.0.0版本的更新。</p>
<p>因此我们也建议，js的更新采用静默更新，native的更新，做出提示。</p>
<p><strong>注意：targetBinaryVersion指的是当前的app版本，比如客户端是1.0.0，如果我们要更新客户端，targetBinaryVersion也要是1.0.0，表示是1.0.0版本的更新，跟native的更新不太一样。这是我们第一次经常犯的错误大家不要搞混了。</strong></p>
<h2 id="2-CodePush-An-update-is-available-but-it-is-being-ignored-due-to-having-been-previously-rolled-back"><a href="#2-CodePush-An-update-is-available-but-it-is-being-ignored-due-to-having-been-previously-rolled-back" class="headerlink" title="2 [CodePush] An update is available, but it is being ignored due to having been previously rolled back."></a>2 <code>[CodePush] An update is available, but it is being ignored due to having been previously rolled back.</code></h2><p>解决方案：一般这种情况是在，我们自定义model，展示更新过程，并监听了安装完成，比如这个<a href="https://github.com/Microsoft/react-native-code-push/blob/master/Examples/CodePushDemoApp/crossplatformdemo.js" target="_blank" rel="external">demo</a>,我这这里忘了在<code>componentDidMount()</code>方法里添加<code>CodePush.notifyApplicationReady();</code>，就一直报这个错误。添加上就ok了</p>
<h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><p><a href="http://blog.csdn.net/oiken/article/details/50279871" target="_blank" rel="external">使用CodePush热更新ReactNative JS代码</a></p>
<p><a href="https://github.com/Microsoft/react-native-code-push#releasing-updates-javascript--images" target="_blank" rel="external">react-native-code-push官方文档</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/android最佳实践（中英文）/" itemprop="url">
                  android最佳实践(中英文)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-16T15:47:06+08:00" content="2016-03-16">
              2016-03-16
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/android/" itemprop="url" rel="index">
                    <span itemprop="name">android</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/post/android最佳实践（中英文）/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="post/android最佳实践（中英文）/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="转载-android最佳实践"><a href="#转载-android最佳实践" class="headerlink" title="转载 android最佳实践"></a>转载 android最佳实践</h1><p><a href="http://blog.csdn.net/asce1885/article/details/43699715" target="_blank" rel="external">转载中文版</a></p>
<p><a href="https://github.com/futurice/android-best-practices" target="_blank" rel="external">转载英文版github地址</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/react-native-android实战：3与原生模块混合开发/" itemprop="url">
                  react-native android实战：3 与原生模块混合开发
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-11T14:47:20+08:00" content="2016-03-11">
              2016-03-11
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/react-native-android实战/" itemprop="url" rel="index">
                    <span itemprop="name">react-native android实战</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/post/react-native-android实战：3与原生模块混合开发/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="post/react-native-android实战：3与原生模块混合开发/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用"></a>如何使用</h1><blockquote>
<p>封装好java模块供JavaScript调用，比如我们用js实现不了的控件或模块，可以通过java实现并封装，供JavaScript使用。</p>
</blockquote>
<h2 id="java模块的封装"><a href="#java模块的封装" class="headerlink" title="java模块的封装"></a>java模块的封装</h2><p>java模块新建LogModule类，继承自ReactContextBaseJavaModule，如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">public class LogModule extends ReactContextBaseJavaModule &#123;</span><br><span class="line"></span><br><span class="line">    private static final String MODULE_NAME= &quot;Log&quot;;</span><br><span class="line">	//构造函数</span><br><span class="line">    public LogModule(ReactApplicationContext reactContext) &#123;</span><br><span class="line">        super(reactContext);</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">	//字符串是JavaScript调用模块的名字</span><br><span class="line">    @Override</span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return MODULE_NAME;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //暴露给JavaScript端的方法</span><br><span class="line">    @ReactMethod</span><br><span class="line">    public void d(String tag,String msg)</span><br><span class="line">    &#123;</span><br><span class="line">        Log.d(tag,msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>新建module注册类,实现自ReactPackage，把module注册如package<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">public class MyAppReactPackage implements ReactPackage &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public List&lt;NativeModule&gt; createNativeModules(ReactApplicationContext reactContext) &#123;</span><br><span class="line"></span><br><span class="line">            List&lt;NativeModule&gt; modules = new ArrayList&lt;&gt;();</span><br><span class="line">            //add Log模块</span><br><span class="line">            modules.add(new LogModule(reactContext));</span><br><span class="line">            //add DBlocal模块</span><br><span class="line">            modules.add(new DBlocalModule(reactContext));</span><br><span class="line">            return modules;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public List&lt;Class&lt;? extends JavaScriptModule&gt;&gt; createJSModules() &#123;</span><br><span class="line">        return Collections.emptyList();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public List&lt;ViewManager&gt; createViewManagers(ReactApplicationContext reactContext) &#123;</span><br><span class="line">        return Collections.emptyList();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>注册包，在MainActivity中<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">    protected List&lt;ReactPackage&gt; getPackages() &#123;</span><br><span class="line">        return Arrays.&lt;ReactPackage&gt;asList(</span><br><span class="line">            new MainReactPackage()</span><br><span class="line">          +  , new VectorIconsPackage()</span><br><span class="line">          +      ,new MyAppReactPackage()</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="js调用封装的java"><a href="#js调用封装的java" class="headerlink" title="js调用封装的java"></a>js调用封装的java</h2><p>我们把需要自定义的java模块，统一管理，放在NativeBrigde.android.js文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//log模块</span><br><span class="line">var RCTLog = NativeModules.Log;</span><br><span class="line">var Log = &#123;</span><br><span class="line">    d: function (tag: string, msg: string): void &#123;</span><br><span class="line">        console.log(tag,msg);</span><br><span class="line">        RCTLog.d(tag, msg);</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">module .exports =&#123;Log,DBlocal&#125;;</span><br></pre></td></tr></table></figure></p>
<p>需要调用的时候<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var &#123;Log,DBlocal&#125; =  require(&apos;../AnComponent/NativeBridge&apos;);`</span><br><span class="line">Log.d(&apos;hehe&apos;,&quot;我是打印输出&quot;);</span><br></pre></td></tr></table></figure></p>
<h2 id="js向java传参"><a href="#js向java传参" class="headerlink" title="js向java传参"></a>js向java传参</h2><p>下面的参数类型在@ReactMethod注明的方法中，会被直接映射到它们对应的JavaScript类型。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Boolean -&gt; Bool</span><br><span class="line">Integer -&gt; Number</span><br><span class="line">Double -&gt; Number</span><br><span class="line">Float -&gt; Number</span><br><span class="line">String -&gt; String</span><br><span class="line">Callback -&gt; function</span><br><span class="line">ReadableMap -&gt; Object</span><br><span class="line">ReadableArray -&gt; Array</span><br></pre></td></tr></table></figure>
<h2 id="java执行结果回传给js"><a href="#java执行结果回传给js" class="headerlink" title="java执行结果回传给js"></a>java执行结果回传给js</h2><h3 id="1-回调"><a href="#1-回调" class="headerlink" title="1 回调"></a>1 <strong>回调</strong></h3><p>java层需要把结果传递给js，答案就是回调，最典型的一个场景就是javascript层调用java层的网络请求方法，java层拿到网络数据后需要将结果返回给javascript层</p>
<p>为了测试我们在已建好的模块新增方法,invoke回调的参数是无类型，无个数限制的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@ReactMethod</span><br><span class="line">    public void getValue(String key,final Callback callback)&#123;</span><br><span class="line">        callback.invoke(&quot;我是结果&quot;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>JavaScript中的使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//从本地数据库取值</span><br><span class="line">DBlocal.getValue(&apos;test&apos;,(result)=&gt;&#123;</span><br><span class="line">    Log.d(&apos;hehe&apos;,result);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>在android studio控制台可以看到结果<br><img src="http://7xrf0l.com1.z0.glb.clouddn.com/16-3-11/46348245.jpg" alt=""></p>
<h3 id="2-事件监听调用"><a href="#2-事件监听调用" class="headerlink" title="2 事件监听调用"></a>2 <strong>事件监听调用</strong></h3><p>还可以用事件调用JavaScript层，假设调用了java层方法后，我们希望发送一个事件给javascript，在javascript层再次进行打印输出。</p>
<p>java端</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@ReactMethod</span><br><span class="line">    public void d(String tag,String msg)&#123;</span><br><span class="line">        Log.d(tag, msg);</span><br><span class="line">        //发送事件给javascript层</span><br><span class="line">        WritableMap params = Arguments.createMap();</span><br><span class="line">        params.putString(&quot;TAG&quot;,tag);</span><br><span class="line">        params.putString(&quot;MSG&quot;,msg);</span><br><span class="line">        getReactApplicationContext()</span><br><span class="line">                .getJSModule(DeviceEventManagerModule.RCTDeviceEventEmitter.class)</span><br><span class="line">                .emit(&quot;logInConsole&quot;, params);//对应的javascript层的事件名为logInConsole，注册该事件即可进行回调</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>而对应的log.js并不需要做什么修改，我们只需要在想获得该事件的地方注册事件即可，比如我们想在主界面接收该事件，则在index.android.js中进行注册。</p>
<p>JavaScript端<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">componentDidMount:function()&#123;</span><br><span class="line">    Log.d(&quot;tag&quot;,&quot;tag&quot;);//调用java层log方法，之后就会回调对应的事件（前提是注册了事件）</span><br><span class="line">    //直接使用DeviceEventEmitter进行事件注册</span><br><span class="line">    DeviceEventEmitter.addListener(&apos;logInConsole&apos;,(e)=&gt;&#123;</span><br><span class="line">       console.log(e);</span><br><span class="line">    &#125;); //记得在UnDidMount里卸载事件</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h1 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p><a href="http://blog.csdn.net/sbsujjbcy/article/details/49953041" target="_blank" rel="external">Android React Native使用原生模块</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/react-native基础：Image资源适配/" itemprop="url">
                  react-native基础：Image资源适配
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-10T14:45:37+08:00" content="2016-03-10">
              2016-03-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/react-native-basis/" itemprop="url" rel="index">
                    <span itemprop="name">react-native basis</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/post/react-native基础：Image资源适配/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="post/react-native基础：Image资源适配/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="判断设备的dpi"><a href="#判断设备的dpi" class="headerlink" title="判断设备的dpi"></a>判断设备的dpi</h1><p>通关官方文档我们了解到，尽量建立统一的image读取路径，便于管理，我们都知道ios的图片资源通过@2x,@3x自动适配,react-native也使用了这一方法。</p>
<p>官方的<a href="http://reactnative.cn/docs/0.21/pixelratio.html#content" target="_blank" rel="external">PixelRatio</a>告诉我们如何获得dpi</p>
<p>static get() </p>
<p>具体用法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var bat = PixelRatio.get();</span><br></pre></td></tr></table></figure></p>
<p>返回设备的像素密度，例如：</p>
<ul>
<li>PixelRatio.get() === 1  <ol>
<li>mdpi Android 设备 (160 dpi)</li>
</ol>
</li>
<li>PixelRatio.get() === 1.5<ol>
<li>hdpi Android 设备 (240 dpi)</li>
</ol>
</li>
<li>PixelRatio.get() === 2 <ol>
<li>iPhone 4, 4S</li>
<li>iPhone 5, 5c, 5s</li>
<li>iPhone 6</li>
<li>xhdpi Android 设备 (320 dpi)</li>
</ol>
</li>
<li>PixelRatio.get() === 3<ol>
<li>iPhone 6 plus</li>
<li>xxhdpi Android 设备 (480 dpi)</li>
</ol>
</li>
<li>PixelRatio.get() === 3.5<ol>
<li>Nexus 6</li>
</ol>
</li>
</ul>
<h1 id="创建不同像素密度的资源"><a href="#创建不同像素密度的资源" class="headerlink" title="创建不同像素密度的资源"></a>创建不同像素密度的资源</h1><p>学习官方文档<a href="http://reactnative.cn/docs/0.21/images.html#content" target="_blank" rel="external">Image</a>可知。<br>我们在src路径存放<code>nav_back@2x.png</code> <code>nav_back@2x.png</code>,加载时调用</p>
<p><code>require(&#39;../src/nav_back.png&#39;)</code></p>
<h1 id="常见的bug"><a href="#常见的bug" class="headerlink" title="常见的bug"></a>常见的bug</h1><h2 id="1-打包apk时报错-Error-Don’t-know-which-android-drawable-suffix-to-use-for-asset"><a href="#1-打包apk时报错-Error-Don’t-know-which-android-drawable-suffix-to-use-for-asset" class="headerlink" title="1 打包apk时报错 Error: Don’t know which android drawable suffix to use for asset:"></a>1 打包apk时报错 Error: Don’t know which android drawable suffix to use for asset:</h2><p><img src="http://7xrf0l.com1.z0.glb.clouddn.com/16-3-10/52551021.jpg" alt=""></p>
<p>参考<a href="https://github.com/facebook/react-native/pull/4527/files" target="_blank" rel="external">github</a></p>
<p>参考<a href="http://stackoverflow.com/questions/35852016/rect-native-drawable-error-when-building-the-android-app" target="_blank" rel="external">stackflow</a></p>
<p>我们知道打开local-cli/bundle/assetPathUtils.js文件可以看到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function getAndroidAssetSuffix(scale) &#123;</span><br><span class="line">      switch (scale) &#123;</span><br><span class="line">            case 0.75: return &apos;ldpi&apos;;</span><br><span class="line">               case 1: return &apos;mdpi&apos;;</span><br><span class="line">                case 1.5: return &apos;hdpi&apos;;</span><br><span class="line">                case 2: return &apos;xhdpi&apos;;</span><br><span class="line">                case 3: return &apos;xxhdpi&apos;;</span><br><span class="line">                case 4: return &apos;xxxhdpi&apos;;</span><br><span class="line">              &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>而我们创建的资源有@3.5x,应该去掉,去掉之后打包就成功了。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/react-native-android实战：2-打包apk/" itemprop="url">
                  react-native android实战：2 打包apk
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-10T14:22:47+08:00" content="2016-03-10">
              2016-03-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/react-native-android实战/" itemprop="url" rel="index">
                    <span itemprop="name">react-native android实战</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/post/react-native-android实战：2-打包apk/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="post/react-native-android实战：2-打包apk/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="为什么要打包"><a href="#为什么要打包" class="headerlink" title="为什么要打包"></a>为什么要打包</h1><p>APP 运行的时候不应再从 Debug Server 获取资源。分发应用时 JS 资源应该被打包到 APP 中。<br>另外对外发布的安装包，资源中的业务代码的混淆也是必须的。</p>
<h1 id="如何打包"><a href="#如何打包" class="headerlink" title="如何打包"></a>如何打包</h1><p>1 创建keystore，使用eclipse，android studio都行</p>
<p>2 拷贝keystore到路径android\app\下</p>
<p>3 修改<code>android\app\build.gradle</code>文件<br> 添加如下内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> android &#123;</span><br><span class="line"></span><br><span class="line">    + signingConfigs &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            storeFile file(&quot;keystore文件名&quot;)</span><br><span class="line">            storePassword &quot;密码&quot;</span><br><span class="line">            keyAlias &quot;&quot;</span><br><span class="line">            keyPassword &quot;密码&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            minifyEnabled enableProguardInReleaseBuilds</span><br><span class="line">            proguardFiles getDefaultProguardFile(&quot;proguard-android.txt&quot;), &quot;proguard-rules.pro&quot;</span><br><span class="line">            + signingConfig signingConfigs.release</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4 在工程目录，运行命令行开始打包</p>
<p><code>cd android &amp;&amp; ./gradlew assembleRelease</code></p>
<h1 id="bug的处理"><a href="#bug的处理" class="headerlink" title="bug的处理"></a>bug的处理</h1><h2 id="1打包资源bug"><a href="#1打包资源bug" class="headerlink" title="1打包资源bug"></a>1打包资源bug</h2><p>解决方法常见我的blog<a href="http://hammercui.github.io/post/react-native%E4%B9%8B%E6%97%85%EF%BC%9AImage%E8%B5%84%E6%BA%90%E9%80%82%E9%85%8D/">react-native之旅：Image资源适配</a>,</p>
<h1 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p><a href="https://github.com/ggchxx/React-Native-Android-Config#react-native-android的配置说明-2015-09-17修改" target="_blank" rel="external">React Native Android的配置说明</a></p>
<p><a href="http://reactnative.cn/docs/0.21/signed-apk-android.html#content" target="_blank" rel="external">官方文档</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/react-native基础：StyleSheet样式属性/" itemprop="url">
                  react-native基础：StyleSheet样式属性
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-09T18:18:25+08:00" content="2016-03-09">
              2016-03-09
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/react-native-basis/" itemprop="url" rel="index">
                    <span itemprop="name">react-native basis</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/post/react-native基础：StyleSheet样式属性/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="post/react-native基础：StyleSheet样式属性/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>以下是StyleSheet所有可用的属性<br><img src="http://7xrf0l.com1.z0.glb.clouddn.com/16-3-9/87816685.jpg" alt=""><br><img src="http://7xrf0l.com1.z0.glb.clouddn.com/16-3-9/69904787.jpg" alt=""><br><img src="http://7xrf0l.com1.z0.glb.clouddn.com/16-3-9/76808690.jpg" alt=""></p>
<p>如果不知道具体的属性怎么写，可以随便写一个，然后运行，报错，react-native会提示你正确的参数，比如我们选择borderStyle，不知随便写，然后报如下错误。<img src="http://7xrf0l.com1.z0.glb.clouddn.com/16-3-9/70960223.jpg" alt=""></p>
<p>这样我们就知道了borderStyle的参数可以使<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;solid&apos;, &apos;dotted&apos;,&apos;dashed&apos;</span><br></pre></td></tr></table></figure></p>
<p>具体什么意思可以翻译。<br>实线 点  虚线</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/react-native-android实战：1-创建项目/" itemprop="url">
                  react-native android实战：1 创建项目
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-07T14:46:52+08:00" content="2016-03-07">
              2016-03-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/react-native-android实战/" itemprop="url" rel="index">
                    <span itemprop="name">react-native android实战</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/post/react-native-android实战：1-创建项目/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="post/react-native-android实战：1-创建项目/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="新建工程"><a href="#新建工程" class="headerlink" title="新建工程"></a>新建工程</h1><p>执行命令 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">react-native init MyProject</span><br></pre></td></tr></table></figure>
<h1 id="导入第三方库"><a href="#导入第三方库" class="headerlink" title="导入第三方库"></a>导入第三方库</h1><p>导入Button库<code>react-native-button</code>，<a href="https://github.com/ide/react-native-button" target="_blank" rel="external">戳这里，打开github</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install react-native-button --save</span><br></pre></td></tr></table></figure>
<p>导入导航库react-native-router-flux，<a href="https://github.com/hammercui/react-native-router-flux" target="_blank" rel="external">点击查看github</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install react-native-router-flux --save</span><br></pre></td></tr></table></figure></p>
<p>导入<a href="https://github.com/reactjs/redux" target="_blank" rel="external">redux</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install redux --save</span><br></pre></td></tr></table></figure>
<p>导入<a href="https://github.com/reactjs/react-redux" target="_blank" rel="external">react-redux</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install react-redux --save</span><br></pre></td></tr></table></figure>
<p>导入<a href="https://github.com/maxs15/react-native-modalbox" target="_blank" rel="external">react-native-modalbox</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install react-native-modalbox --save</span><br></pre></td></tr></table></figure>
<p>react-native-modalbox如下图<img src="https://camo.githubusercontent.com/d4a496a80e4159490d873dcc37e93b71d6da7e0b/687474703a2f2f692e696d6775722e636f6d2f3358554c4c74382e676966" alt=""></p>
<p>导入<a href="https://github.com/oblador/react-native-vector-icons" target="_blank" rel="external">react-native-vector-icons</a>        </p>
<p><code>react-native-vector-icons</code>是github中很火的开源图标项目，解决我们找四处找图标的麻烦</p>
<p><strong>注意在android使用中，一定不要忘记把<code>node_modules\react-native-vector-icons\Fonts</code>下的所有文件拷贝到<code>android/app/src/main/assets/fonts</code>路径</strong></p>
<h1 id="执行"><a href="#执行" class="headerlink" title="执行"></a>执行</h1><p>打开服务 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">react-native start</span><br></pre></td></tr></table></figure>
<p>android虚拟机或真机运行  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">react-native run-android</span><br></pre></td></tr></table></figure>
<h1 id="推荐的IDE"><a href="#推荐的IDE" class="headerlink" title="推荐的IDE"></a>推荐的IDE</h1><p>使用webstorm11,代码补全以及文件索引，要优于atom跟sublime text</p>
<h1 id="推荐模拟器"><a href="#推荐模拟器" class="headerlink" title="推荐模拟器"></a>推荐模拟器</h1><p><a href="https://developer.xamarin.com/guides/android/getting_started/installation/android-player/" target="_blank" rel="external">Xamarin Android Player</a>,自带的菜单按钮特别方便，genymotion在win10经常起不来，后来试用了xamarin，发现相当稳定，强烈推荐</p>
<h1 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h1><p>5.0以下 点击memu菜单或者摇晃机身，弹出选项，选择<code>reload js</code></p>
<p>5.0以上 首先adb reverse tcp:8081 tcp:8081，然后摇晃机身</p>
<h1 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p><a href="http://richard-cao.github.io/2015/11/24/React-native-Android-%E5%88%9D%E6%AC%A1%E8%B8%A9%E5%9D%91%E4%B9%8B%E6%97%85/" target="_blank" rel="external">React-Native Android 初次踩坑之旅</a></p>
<p><a href="http://bbs.reactnative.cn/topic/10/%E5%9C%A8windows%E4%B8%8B%E6%90%AD%E5%BB%BAreact-native-android%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83" target="_blank" rel="external">在windows下搭建react-native-android开发环境</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://avatar.coolapk.com/data/000/65/51/50_avatar_middle.jpg"
               alt="hammercui" />
          <p class="site-author-name" itemprop="name">hammercui</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">68</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">13</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">19</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/hammercui" target="_blank" title="github">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  github
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://logicool.github.io/" title="logicool的技术专栏" target="_blank">logicool的技术专栏</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://xiekw2010.github.io" title="xiekw2010的专栏" target="_blank">xiekw2010的专栏</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.lcode.org/" title="江清清的技术专栏" target="_blank">江清清的技术专栏</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">hammercui</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"hammercui"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  






  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });

                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  

</body>
</html>
